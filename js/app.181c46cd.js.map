{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/backpack.js","webpack:///./src/scripts/config.js","webpack:///./src/scripts/events.js","webpack:///./src/scripts/keyboard.js","webpack:///./src/scripts/entities.js","webpack:///./src/scripts/world.js","webpack:///./src/scripts/utils.js","webpack:///./src/scripts/character.js","webpack:///./src/scripts/textprompt.js","webpack:///./src/scripts/slide.js","webpack:///./src/scripts/actionEvents.js","webpack:///./src/scripts/hunger.js","webpack:///./src/scripts/particles.js","webpack:///./src/scripts/thermometer.js","webpack:///./src/scripts/index.js","webpack:///./src/scripts/localsettings.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","BackpackBar","constructor","this","container","PIXI","width","getComponent","renderBackpack","items","removeChildren","sprite","sprites","item","resources","texture","getSprites","addChild","config","debug","E_PLAYER_MOVED","E_SET_WORLD_LOCK","E_ENTITY_DISPATCH_ACTIONS","E_DESTROY_ENTITY","E_SET_GLOBAL","E_INC_GLOBAL","E_APPEND_GLOBAL","E_DEPEND_GLOBAL","E_GO_TO_WORLD","E_ABORT_EVENT_FLOW","E_START_QUEUING_EVENTS","E_STOP_QUEUING_EVENTS","E_ADD_HUNGER","E_RUN_EVENTS","E_SET_WEATHER_INTENSITY","E_ADD_BACKPACK_ITEM","E_DID_UPDATE_BACKPACK_CONTENTS","E_SET_TEMPRATURE","E_SET_CHARACTER_OPACITY","E_REQUEST_PLACE_ENTITY","E_SET_ENTITY_POSITION","EE","EventEmitter","addDebugLogger","event","on","console","log","Config","KEY_DOWN","KEY_UP","KEY_LEFT","KEY_RIGHT","KEY_SPACE","KEY_ESCAPE","KeyboardEventHandler","keyCode","onPress","onRelease","assign","isKeyDown","isKeyUp","allowRepeat","oneShot","everPressed","bindListeners","addEventListener","downHandler","upHandler","evt","preventDefault","Entity","x","y","entitySpec","id","anchor","set","TILE_SIZE","tileScale","height","flip","events","dispatchInteractionActions","movementLocked","setVisible","spawnVisible","visible","alpha","isWalkable","walkable","emit","ticker","delta","character","move","_doMove","setLocation","moveIndex","speed","moveSpeed","target","xDiff","yDiff","movedX","movedY","Math","abs","collidesWith","FishEntity","random","super","type","text","content","startY","time","sinTime","sin","rotation","PI","DEFAULT_WEATHER_INTENSITY","FISH_CHANCE","randomisedTiles","ice_m1","ice_m2","ice_m3","Tile","solid","trim","loadSprite","[object Object]","textureLocation","idx","min","max","floor","getRandomInt","fromImage","World","world","entities","tileData","fileToTileData","loadWorld","loadWorldSpec","inCollision","Set","forEach","e","index","indexOf","removeChild","row","tile","createTile","createFish","fish","worldSpec","yaml","safeLoad","placeEntities","intensity","initialWeatherIntensity","worldData","rows","split","entity","spawnKey","error","charCodeAt","parts","img","gridSpace","getTile","isSolid","isPositionOkay","xt","round","yt","collidesAt","collidees","add","getStartingPosition","playerStart","updateCollisionStates","newCollidees","collidee","has","delete","doDetectCollisions","WorldContainer","uiContainer","values","worldChangeCallbacks","registerEventListeners","vals","concat","setSepia","sepia","doCheck","val","check","registerWorldChangeCallback","fn","worldId","_setWorld","hideCharacter","cb","entity_x","entity_y","entity_w","entity_h","tileToGlobal","size","MOVE_PER_TICK","STEP_HUNGER_TIME","STEP_HUNGER_REMOVAL","IDLE_ENERGY_BURN","PlayerMovedContext","Character","stepTimer","metabolicRate","animationFrames","b","makeAnimation","f","backpack","animation","AnimatedSprite","animationSpeed","play","moveDown","moveUp","moveLeft","moveRight","keyboardTick","shouldBurnEnergy","stop","exp","velocityX","velocityY","loadPlayerSpec","loader","Loader","load","playerSpec","onComplete","dir","frames","fromFrame","moveBy","hasMoved","textures","newY","newX","updateEnergy","energyToBurn","getLocation","getX","getY","TEXT_PADDING","BOX_MARGIN","TextPrompt","w","h","conf","parentContainer","finishCallback","speakerName","textLen","timer","dismissHandler","textComponent","fontFamily","fontSize","wordWrap","wordWrapWidth","graphics","_makeBackground","readyPrompt","_makeReadyPrompt","par","scale","flipSide","lineStyle","beginFill","drawRoundedRect","endFill","onFinish","getTextStringWithSpeaker","substr","finished","_hasprompt","flopped","Slide","image","worldContainer","setupContainer","runEvents","hitboxes","GameApp","renderer","startX","hitbox","showIf","show","case","hitboxarea","interactive","triggerEvent","callback","disabled","aborted","EventQueue","eventQueue","queueEvents","eventSpec","onDone","dispatchQueuedEvents","dispatcher","queuedEvents","ev","ActionEventHandler","worldWidth","worldHeight","currentEventKey","tickers","currentEventKeys","abortingFlow","_dispatchQueuedEvents","_runEvents","loadEvents","doEvent","shouldAbort","_shouldAbortEvent","_getEventKey","eventChain","eventHandler","makeEventHandler","newTextHandler","newSlideHandler","newEventDispatcher","newCheck","newQuitEventFlow","newDelayEventsFlow","alreadyFinished","async","setTimeout","prompt","speaker_name","slide","done","HungerMeter","hunger","setBar","fishIcon","diff","addHunger","bar","colour","snowEmitter","maxParticles","spawnChance","minimumSpeedMultiplier","Thermometer","temperature","drawCircle","thermoIcon","temp","setTemperature","keys","__webpack_exports__","FULL_WIDTH","DEFAULT_WORLD_ID","innerWidth","innerHeight","backgroundColor","initGame","document","body","appendChild","view","background","tilingBackground","TilingSprite","getBackground","stage","bgTicker","cos","startingPosition","clouds","blendMode","getClouds","Emitter","start","end","minimumScaleMultiplier","color","acceleration","maxSpeed","startRotation","noRotation","rotationSpeed","lifetime","frequency","emitterLifetime","pos","addAtBack","spawnType","spawnRect","update","newSnow","hungerMeter","backpackBar","backpackComponent","thermometer","screen","context","vignette","pivot","xx","yy","setWorld","loadRootAssets","worldLoader","worlds"],"mappings":"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","file":"js/app.181c46cd.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([230,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import * as PIXI from \"pixi.js\";\n\nexport class BackpackBar {\n    constructor() {\n        this.container = new PIXI.Container();\n        this.container.width = 100;\n    }\n\n    getComponent() {\n        return this.container;\n    }\n\n    renderBackpack(items) {\n        this.container.removeChildren();\n        for (let sprite of getSprites(items)) {\n            this.container.addChild(sprite);\n        }\n    }\n}\n\nfunction getSprites(items) {\n    let sprites = [];\n    for (let item of items) {\n        sprites.push(new PIXI.Sprite(\n            PIXI.loader.resources[item].texture\n        ));\n    }\n    return sprites;\n}\n","export default {\n    \"debug\": true,\n};\n","import EventEmitter from 'eventemitter3';\nimport Config from \"./config\";\n\nexport const E_PLAYER_MOVED = 'PLAYER_MOVED';\nexport const E_SET_WORLD_LOCK = 'SET_WORLD_LOCK';\nexport const E_ENTITY_DISPATCH_ACTIONS = 'ENTITY_DISPATCH_ACTIONS';\nexport const E_DESTROY_ENTITY = 'DESTROY_ENTITY';\nexport const E_SET_GLOBAL = 'SET_GLOBAL';\nexport const E_INC_GLOBAL = 'INC_GLOBAL';\nexport const E_APPEND_GLOBAL = 'APPEND_GLOBAL';\nexport const E_DEPEND_GLOBAL = 'DEPEND_GLOBAL';\nexport const E_GO_TO_WORLD = 'GO_TO_WORLD';\nexport const E_ABORT_EVENT_FLOW = 'ABORT_EVENT_FLOW';\nexport const E_START_QUEUING_EVENTS = 'START_QUEUING_EVENTS';\nexport const E_STOP_QUEUING_EVENTS = 'STOP_QUEUING_EVENTS';\nexport const E_ADD_HUNGER = 'ADD_HUNGER';\nexport const E_RUN_EVENTS = 'RUN_EVENTS';\nexport const E_SET_WEATHER_INTENSITY = 'SET_WEATHER_INTENSITY';\nexport const E_ADD_BACKPACK_ITEM = 'ADD_BACKPACK_ITEM';\nexport const E_DID_UPDATE_BACKPACK_CONTENTS = 'DID_UPDATE_BACKPACK_CONTENTS';\nexport const E_SET_TEMPRATURE = 'SET_TEMPERATURE';\nexport const E_SET_CHARACTER_OPACITY = 'SET_CHARACTER_OPACITY';\nexport const E_REQUEST_PLACE_ENTITY = 'REQUEST_PLACE_ENTITY';\nexport const E_SET_ENTITY_POSITION = 'E_SET_ENTITY_POSITION';\nexport const E_SET_METABOLIC_RATE = 'SET_METABOLIC_RATE';\n\nlet EE = new EventEmitter();\n\nfunction addDebugLogger(event) {\n    EE.on(event, () => {\n        console.log('Received event: ' + event);\n    });\n}\n\nif (Config.debug) {\n    addDebugLogger(E_SET_WORLD_LOCK);\n    addDebugLogger(E_ENTITY_DISPATCH_ACTIONS);\n    addDebugLogger(E_DESTROY_ENTITY);\n    addDebugLogger(E_SET_GLOBAL);\n    addDebugLogger(E_INC_GLOBAL);\n    addDebugLogger(E_APPEND_GLOBAL);\n    addDebugLogger(E_DEPEND_GLOBAL);\n    addDebugLogger(E_GO_TO_WORLD);\n    addDebugLogger(E_ABORT_EVENT_FLOW);\n    addDebugLogger(E_START_QUEUING_EVENTS);\n    addDebugLogger(E_STOP_QUEUING_EVENTS);\n    addDebugLogger(E_ADD_HUNGER);\n    addDebugLogger(E_RUN_EVENTS);\n    addDebugLogger(E_SET_WEATHER_INTENSITY);\n    addDebugLogger(E_ADD_BACKPACK_ITEM);\n    addDebugLogger(E_DID_UPDATE_BACKPACK_CONTENTS);\n    addDebugLogger(E_SET_TEMPRATURE);\n    addDebugLogger(E_SET_CHARACTER_OPACITY);\n    addDebugLogger(E_REQUEST_PLACE_ENTITY);\n    addDebugLogger(E_SET_ENTITY_POSITION);\n    addDebugLogger(E_SET_METABOLIC_RATE);\n}\n\nexport default EE;\n","\nexport const KEY_DOWN = 40;\nexport const KEY_UP = 38;\nexport const KEY_LEFT = 37;\nexport const KEY_RIGHT = 39;\nexport const KEY_SPACE = 32;\nexport const KEY_ESCAPE = 27;\n\n\nexport class KeyboardEventHandler {\n    constructor(keyCode, onPress = null, onRelease = null) {\n        // default properties\n        Object.assign(this, {\n            \"isKeyDown\": false,\n            \"isKeyUp\": true,\n        });\n\n        this.allowRepeat = true;\n        this.keyCode = keyCode;\n\n        this.oneShot = false;\n        this.everPressed = false;\n\n        if (onPress !== null) {\n            this.onPress = onPress;\n        }\n        if (onRelease !== null) {\n            this.onRelease = onRelease;\n        }\n    }\n\n    bindListeners() {\n        window.addEventListener(\n            \"keydown\", this.downHandler.bind(this), false\n        );\n        window.addEventListener(\n            \"keyup\", this.upHandler.bind(this), false\n        );\n\n        // allow chaining\n        return this;\n    }\n\n    downHandler(evt) {\n        if (evt.keyCode !== this.keyCode) {\n            return;\n        }\n\n        if (this.everPressed && this.oneShot) {\n            return;\n        }\n\n        this.everPressed = true;\n\n        if (this.allowRepeat || !this.isKeyDown) {\n            this.isKeyDown = true;\n            this.isKeyUp = false;\n            this.onPress();\n        }\n        evt.preventDefault();\n    }\n\n    upHandler(evt) {\n        if (evt.keyCode === this.keyCode) {\n            this.isKeyDown = false;\n            this.isKeyUp = true;\n            this.onRelease();\n        }\n        evt.preventDefault();\n    }\n\n    // default onPress and onRelease handlers\n    onPress() {\n        return;\n    }\n\n    onRelease() {\n        return;\n    }\n}\n","import * as PIXI from \"pixi.js\";\nimport EE, {\n    E_ADD_HUNGER,\n    E_DESTROY_ENTITY,\n    E_ENTITY_DISPATCH_ACTIONS,\n    E_SET_WORLD_LOCK\n} from \"./events\";\nimport { KeyboardEventHandler } from \"./keyboard\";\nimport { TILE_SIZE } from \"./world\";\n\nexport class Entity {\n    constructor(x, y, texture, entitySpec) {\n        this.id = entitySpec.id || 'ALL_OTHER_ENTITIES';\n        this.entitySpec = entitySpec;\n\n        this.sprite = new PIXI.Sprite(texture);\n\n        // x,y is in the tile coordinate system\n        this.sprite.anchor.set(0.5);\n        this.sprite.x = x * TILE_SIZE;\n        this.sprite.y = y * TILE_SIZE;\n        this.sprite.width = TILE_SIZE * (this.entitySpec.tileScale || 1);\n        this.sprite.height = TILE_SIZE * (this.entitySpec.tileScale || 1);\n\n        if (entitySpec.flip) {\n            this.sprite.width = -this.sprite.width;\n        }\n\n        this.events = entitySpec.events;\n\n        this.dispatchInteractionActions = this.dispatchInteractionActions.bind(this);\n\n        this.movementLocked = false;\n        EE.on(E_SET_WORLD_LOCK, (x) => this.movementLocked = x);\n\n        this.setVisible(entitySpec.spawnVisible || typeof entitySpec.spawnVisible === 'undefined');\n    }\n\n    setVisible(visible) {\n        this.visible = visible;\n        this.sprite.alpha = (visible) ? 1.0 : 0.0;\n    }\n\n    isWalkable() {\n        return !!this.entitySpec.walkable;\n    }\n\n    dispatchInteractionActions() {\n        if (!this.visible) {\n            return;\n        }\n\n        if (this.entitySpec.events) {\n            EE.emit(E_ENTITY_DISPATCH_ACTIONS, this.entitySpec.events);\n        }\n    }\n\n    ticker(delta, character) {\n        if (this.entitySpec.move) {\n            this._doMove(delta, character);\n        }\n    }\n\n    setLocation(x, y) {\n        this.sprite.x = x;\n        this.sprite.y = y;\n    }\n\n    _doMove(delta, character) {\n        if (this.movementLocked) {\n            return;\n        }\n        this.moveIndex = this.moveIndex || 0;\n\n        let speed = this.entitySpec.moveSpeed || 1;\n        let target = this.entitySpec.move[this.moveIndex];\n\n        let xDiff = this.sprite.x - (target.x * TILE_SIZE);\n        let yDiff = this.sprite.y - (target.y * TILE_SIZE);\n\n        let movedX = 0, movedY = 0;\n        if (Math.abs(xDiff) > 10) {\n            movedX = (xDiff > 0 ? -1 : 1) * delta * speed;\n            this.sprite.x += movedX;\n        }\n        if (Math.abs(yDiff) > 10) {\n            movedY = (yDiff > 0 ? -1 : 1) * delta * speed;\n            this.sprite.y += movedY;\n        }\n\n        if (character.collidesWith(this)) {\n            character.sprite.x += movedX;\n            character.sprite.y += movedY;\n        }\n\n        if (Math.abs(xDiff) < 10 && Math.abs(yDiff) < 10) {\n            this.moveIndex = (this.moveIndex+1) % this.entitySpec.move.length;\n        }\n    }\n}\n\nexport class FishEntity extends Entity {\n    constructor(x, y) {\n        let id = Math.random();\n        super(x, y, PIXI.loader.resources['fish'].texture, {\n            id: id,\n            events: [{\n                type: 'text',\n                text: 'You found a fish! Hunger replenished.',\n            }, {\n                type: 'event',\n                event: E_ADD_HUNGER,\n                content: 25,\n            }, {\n                type: 'event',\n                event: E_DESTROY_ENTITY,\n                content: id,\n            }]\n        });\n        this.startY = this.sprite.y;\n        this.time = Math.random()*200;\n    }\n\n    ticker(delta, character) {\n        this.time += delta;\n        let sinTime = Math.sin(this.time/15);\n        sinTime = sinTime > 0 ? 0 : sinTime;\n        this.sprite.y = this.startY + (sinTime * 10);\n        this.sprite.rotation = sinTime * Math.PI/10 * Math.random();\n    }\n}","import * as PIXI from \"pixi.js\";\nimport yaml from \"js-yaml\";\nimport log from \"loglevel\";\n\nimport {\n    E_APPEND_GLOBAL, E_DEPEND_GLOBAL,\n    E_ABORT_EVENT_FLOW,\n    E_START_QUEUING_EVENTS, E_STOP_QUEUING_EVENTS,\n    E_DESTROY_ENTITY,\n    E_INC_GLOBAL,\n    E_SET_GLOBAL,\n    E_GO_TO_WORLD,\n    E_SET_WEATHER_INTENSITY,\n    E_REQUEST_PLACE_ENTITY,\n    E_SET_ENTITY_POSITION,\n    makeEventHander, E_SET_CHARACTER_OPACITY\n} from \"./events\";\nimport { getRandomInt } from \"./utils\";\nimport { KeyboardEventHandler } from \"./keyboard\";\n\nimport EE, {\n    E_PLAYER_MOVED,\n} from \"./events\";\nimport { Entity, FishEntity } from \"./entities\";\n\nconst DEFAULT_WEATHER_INTENSITY = 0.0;\n\nexport const TILE_SIZE = 64;\nexport const FISH_CHANCE = 0.002;\n\nlet randomisedTiles = {\n    'ice_m1': ['ice_m1', 'ice_m1a'],\n    'ice_m2': ['ice_m2', 'ice_m2a', 'ice_m2b'],\n    'ice_m3': ['ice_m3', 'ice_m3a']\n};\n\nclass Tile {\n    constructor(x, y, sprite, solid) {\n        this.x = x;\n        this.y = y;\n\n        // Can't move through it\n        this.sprite = sprite.trim() ? Tile.loadSprite(sprite) : null;\n        this.solid = !(this.sprite) || solid;\n        if (this.sprite) {\n            this.sprite.anchor.set(0.5);\n            this.sprite.x = x * TILE_SIZE;\n            this.sprite.y = y * TILE_SIZE;\n            this.sprite.width = TILE_SIZE;\n            this.sprite.height = TILE_SIZE;\n        }\n    }\n\n    static loadSprite(textureLocation) {\n        // create a new Sprite from an image path\n        if (randomisedTiles.hasOwnProperty(textureLocation)) {\n            const idx = getRandomInt(0, randomisedTiles[textureLocation].length - 1);\n            textureLocation = randomisedTiles[textureLocation][idx];\n        }\n        const texture = PIXI.Texture.fromImage('public/assets/sprites/' + textureLocation + '.png');\n        return new PIXI.Sprite(texture);\n    }\n}\n\nclass World {\n    constructor(id) {\n        this.container = new PIXI.Container();\n\n        // Tiles in the world\n        this.world = [];\n\n        // Entities present in the world\n        this.entities = [];\n\n        let tileData = this.fileToTileData(id);\n        this.loadWorld(tileData);\n        this.loadWorldSpec(id);\n\n        this.inCollision = new Set();\n\n        EE.on(E_DESTROY_ENTITY, (id) => {\n            this.entities.forEach((e, i) => {\n                if (e.id === id) {\n                    // Lol we already found it previously\n                    const index = this.entities.indexOf(e);\n                    this.entities.splice(index, 1);\n                    this.container.removeChild(e.sprite);\n                }\n            });\n        });\n\n        EE.on(E_REQUEST_PLACE_ENTITY, (id) => {\n            console.log(\"placing entity \" + id);\n            this.entities.forEach((e, i) => {\n                if (e.id === id) {\n                    e.setVisible(true);\n                }\n            });\n        });\n\n        EE.on(E_SET_ENTITY_POSITION, ({ id, x, y }) => {\n            this.entities.forEach((e, i) => {\n                if (e.id === id) {\n                    e.setLocation(x, y);\n                }\n            });\n        });\n    }\n\n    loadWorld(tileData) {\n        this.world = [];\n        for (let y = 0; y < tileData.length; y++) {\n            let row = [];\n            for (let x = 0; x < tileData[y].length; x++) {\n                let tile = this.createTile(x, y, tileData[y][x]);\n                if (tile && Math.random() < FISH_CHANCE) {\n                    this.createFish(x, y);\n                }\n                row.push(tile);\n            }\n            this.world.push(row);\n        }\n    }\n\n    createFish(x, y) {\n        let fish = new FishEntity(x, y);\n        this.container.addChild(fish.sprite);\n        this.entities.push(fish);\n    }\n\n    loadWorldSpec(world) {\n        let worldSpec = PIXI.loader.resources['world' + world + '_spec'].data;\n        this.worldSpec = yaml.safeLoad(worldSpec);\n        this.placeEntities(this.worldSpec.entities);\n\n        const intensity = this.worldSpec.initialWeatherIntensity || DEFAULT_WEATHER_INTENSITY;\n        EE.emit(E_SET_WEATHER_INTENSITY, intensity);\n    }\n\n    fileToTileData(world) {\n        let worldData = PIXI.loader.resources['world' + world + '_tiles'].data;\n        let rows = worldData ? worldData.split(/\\r\\n|\\n/) : '';\n\n        let tileData = [];\n        for (let y = 0; y < rows.length; y++) {\n            tileData.push(rows[y].split(','));\n        }\n        return tileData;\n    }\n\n    placeEntities(entities) {\n        for (let entity of entities) {\n            this.entities.push(new Entity(\n                entity.x, entity.y,\n                PIXI.loader.resources[entity.sprite].texture,\n                entity\n            ));\n\n            if (entity.spawnKey) {\n                if (typeof entity.id === 'undefined') {\n                    log.error(\"Entities with spawnKey must have an id!\");\n                }\n\n                new KeyboardEventHandler(\n                    entity.spawnKey.charCodeAt(0),\n                    () => { EE.emit(E_REQUEST_PLACE_ENTITY, entity.id); }\n                )\n                    .bindListeners()\n                    .oneShot = true;\n            }\n        }\n\n        for (let entity of this.entities) {\n            this.container.addChild(entity.sprite);\n        }\n    }\n\n    createTile(x, y, data) {\n        let parts = data.split(',');\n        let img = parts[0];\n        if (img.trim() === '') {\n            return null;\n        }\n        let solid = (parts.length > 1 && parts[1] === 's');\n\n        let gridSpace = new Tile(x, y, img, solid);\n        if (gridSpace.sprite) {\n            this.container.addChild(gridSpace.sprite);\n        }\n        return gridSpace;\n    }\n\n    getTile(x, y) {\n        let row = this.world[y] || [];\n        return row[x];\n    }\n\n    isSolid(x, y) {\n        let tile = this.getTile(x, y);\n        return !tile || tile.solid;\n    }\n\n    isPositionOkay(x, y) {\n        let xt = Math.round(x / TILE_SIZE);\n        let yt = Math.round(y / TILE_SIZE);\n        let solid = !this.isSolid(xt, yt);\n\n        if (solid) {\n            return solid;\n        }\n\n        // Check if the position has entities that are walkable\n        for (let entity of this.entities) {\n            if (collidesWith(entity, x, y)) {\n                if (entity.isWalkable()) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    collidesAt(x, y) {\n        let collidees = new Set();\n        for (let entity of this.entities) {\n            if (collidesWith(entity, x, y)) {\n                collidees.add(entity);\n            }\n        }\n        return collidees;\n    }\n\n    getStartingPosition() {\n        const playerStart = this.worldSpec.playerStart;\n        if (typeof playerStart !== 'undefined' &&\n            playerStart.x && playerStart.y) {\n            return playerStart;\n        } else {\n            // TODO(matt): ensure this is actually on a tile!\n            return {\n                'x': 1,\n                'y': 1,\n            };\n        }\n    }\n\n    updateCollisionStates(newCollidees) {\n        // Entities we are no longer in collision with\n        this.inCollision.forEach((collidee) => {\n            if (!newCollidees.has(collidee)) {\n                this.inCollision.delete(collidee);\n            }\n        });\n\n        // And look for new colliders, and tell them to dispatch actions\n        newCollidees.forEach((collidee) => {\n            if (!this.inCollision.has(collidee)) {\n                this.inCollision.add(collidee);\n                collidee.dispatchInteractionActions();\n            }\n        });\n    }\n\n    doDetectCollisions(x, y) {\n        let collidees = this.collidesAt(x, y);\n        this.updateCollisionStates(collidees);\n    }\n\n    ticker(delta, character) {\n        for (let entity of this.entities) {\n            entity.ticker(delta, character);\n        }\n    }\n}\n\nexport class WorldContainer {\n    constructor(uiContainer) {\n        this.uiContainer = uiContainer;\n\n        this.values = {};\n        this.world = null;\n        this.worldChangeCallbacks = [];\n        this.container = new PIXI.Container();\n        this.registerEventListeners();\n\n        EE.on(E_SET_GLOBAL, (vals) => {\n            this.values[vals.key] = vals.value;\n            console.log('setting values', this.values);\n        });\n        EE.on(E_INC_GLOBAL, (vals) => {\n            this.values[vals.key] = (this.values[vals.key] || 0) + vals.value;\n            console.log('adding values', this.values);\n        });\n        EE.on(E_APPEND_GLOBAL, (vals) => {\n            this.values[vals.key] = (this.values[vals.key] || []).concat([vals.value]);\n            console.log('concat values', this.values);\n        });\n        EE.on(E_DEPEND_GLOBAL, (vals) => {\n            const index = (this.values[vals.key] || []).indexOf(vals.value);\n            if (index) {\n                this.values[vals.key].splice(index, 1);\n            }\n            console.log('depend values', this.values);\n        });\n    }\n\n    setSepia(on) {\n        if (this.sepia && !on) {\n            this.uiContainer.removeChild(this.sepia);\n        } else if (!this.sepia && on) {\n            this.sepia = new PIXI.Sprite(PIXI.loader.resources['sepia'].texture);\n            this.sepia.x = 0;\n            this.sepia.y = 0;\n            this.sepia.alpha = 0.5;\n            this.uiContainer.addChild(this.sepia);\n        }\n    }\n\n    doCheck(key, val, check) {\n        let value = this.values[key];\n        if (!value) {\n            return false;\n        }\n        switch (check) {\n            case 'eq':\n                return value == val;\n            case 'gt':\n                return value > val;\n            case 'lt':\n                return value < val;\n        }\n        console.error('unknown comparator', check);\n        return false;\n    }\n\n    doDetectCollisions(x, y) {\n        this.world && this.world.doDetectCollisions(x, y);\n    }\n\n    registerWorldChangeCallback(fn) {\n        this.worldChangeCallbacks.push(fn);\n    }\n\n    registerEventListeners() {\n        EE.on(E_GO_TO_WORLD, (worldId) => this._setWorld(worldId));\n    }\n\n    _setWorld(id) {\n        console.log(\"Setting world to: \" + id);\n\n        // Break any active event flow on world change\n        EE.emit(E_ABORT_EVENT_FLOW);\n\n        EE.emit(E_START_QUEUING_EVENTS);\n\n        if (this.world) {\n            console.log(\"Removing previous world\");\n            this.container.removeChild(this.world.container);\n        }\n\n        this.world = new World(id);\n        this.container.addChild(this.world.container);\n\n        this.setSepia(this.world.worldSpec.sepia);\n\n        EE.emit(E_SET_CHARACTER_OPACITY, this.world.worldSpec.hideCharacter ? 0 : 1);\n\n        for (let cb of this.worldChangeCallbacks) {\n            cb(this.world, this);\n        }\n\n        EE.emit(E_STOP_QUEUING_EVENTS);\n    }\n}\n\nexport function collidesWith(entity, x, y) {\n    // Character (x, y) is in collision with entity if the following all hold:\n    //\n    // entity_x_position - entity_width/2 <= x <= entity_x_position + entity_width/2\n    // entity_y_position - entity_height/2 <= y <= entity_y_position + entity_height/2\n    //\n    // The character is currently modelled as a particle for this purpose. We\n    // assume entities are anchored at their midpoint.\n\n    const entity_x = entity.sprite.x;\n    const entity_y = entity.sprite.y;\n    const entity_w = entity.sprite.width;\n    const entity_h = entity.sprite.height;\n\n    const collidesX = (entity_x - (entity_w / 2) <= x) && (entity_x + (entity_w / 2) >= x);\n    const collidesY = (entity_y - (entity_h / 2) <= y) && (entity_y + (entity_h / 2) >= y);\n\n    return collidesX && collidesY;\n}\n\nexport function tileToGlobal(size) {\n    return size * TILE_SIZE;\n}\n","/**\n * Returns a random integer between min (inclusive) and max (inclusive)\n * Using Math.round() will give you a non-uniform distribution!\n */\nexport function getRandomInt(min, max) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n","import * as PIXI from \"pixi.js\";\n\nimport EE, {\n    E_ADD_HUNGER,\n    E_PLAYER_MOVED, E_SET_WORLD_LOCK,\n    E_ADD_BACKPACK_ITEM,\n    E_DID_UPDATE_BACKPACK_CONTENTS, E_SET_CHARACTER_OPACITY,\n    E_REQUEST_PLACE_ENTITY,\n    E_SET_ENTITY_POSITION,\n    E_SET_WEATHER_INTENSITY\n} from \"./events\";\nimport {\n    KeyboardEventHandler,\n    KEY_DOWN,\n    KEY_UP,\n    KEY_LEFT,\n    KEY_RIGHT,\n} from \"./keyboard\";\nimport {\n    collidesWith,\n    tileToGlobal\n} from \"./world\";\nimport yaml from \"js-yaml\";\n\nconst SPRITE_IMAGE = 'public/assets/bunny.png';\nconst MOVE_PER_TICK = 3;\n\nconst STEP_HUNGER_TIME = 20;\nconst STEP_HUNGER_REMOVAL = 1;\nconst IDLE_ENERGY_BURN = 0.2;\n\nclass PlayerMovedContext {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n}\n\nexport class Character {\n    constructor() {\n        this.stepTimer = 0;\n        this.container = new PIXI.Container();\n\n        this.metabolicRate = 1.0;\n\n        this.animationFrames = {\n            b: this.makeAnimation('b', [1, 2, 3, 2]),\n            f: this.makeAnimation('f', [1, 2, 3, 2]),\n            l: this.makeAnimation('l', [1, 2, 3, 2]),\n            r: this.makeAnimation('r', [1, 2, 3, 2]),\n        };\n\n        this.backpack = new Set();\n\n        let animation = new PIXI.extras.AnimatedSprite(this.animationFrames.r);\n        animation.animationSpeed = 0.1;\n        animation.width = animation.width*0.5;\n        animation.height = animation.height*0.5;\n        animation.anchor.set(0.5, 0.75);\n        animation.play();\n\n        this.container.addChild(animation);\n\n        this.sprite = animation;\n\n        this.moveDown = new KeyboardEventHandler(KEY_DOWN);\n        this.moveUp = new KeyboardEventHandler(KEY_UP);\n        this.moveLeft = new KeyboardEventHandler(KEY_LEFT);\n        this.moveRight = new KeyboardEventHandler(KEY_RIGHT);\n        this.moveDown.bindListeners();\n        this.moveUp.bindListeners();\n        this.moveLeft.bindListeners();\n        this.moveRight.bindListeners();\n\n        this.keyboardTick = this.keyboardTick.bind(this);\n\n        this.shouldBurnEnergy = true;\n\n        // This may be a bad idea - probably not, it's been here for 9 hours?\n        this.movementLocked = false;\n        EE.on(E_SET_WORLD_LOCK, (x) => {\n            this.movementLocked = x;\n            if (x) {\n                this.sprite.stop();\n            }\n        });\n\n        EE.on(E_ADD_BACKPACK_ITEM, (item) => {\n            this.backpack.add(item);\n            console.log(\"BACKPACK: \", this.backpack);\n            EE.emit(E_DID_UPDATE_BACKPACK_CONTENTS);\n        });\n\n        EE.on(E_SET_CHARACTER_OPACITY, (alpha) => {\n            this.sprite.alpha = alpha;\n            this.shouldBurnEnergy = alpha > 0;\n        });\n\n        // When we place entities, we want the character's current position to\n        // influence the placed position of the entity\n        EE.on(E_REQUEST_PLACE_ENTITY, (id) => {\n            EE.emit(E_SET_ENTITY_POSITION, { id: id, x: this.sprite.x, y: this.sprite.y });\n        });\n\n        // Metabolic rate is related to weather intensity\n        EE.on(E_SET_WEATHER_INTENSITY, (intensity) => {\n            this.metabolicRate = Math.exp(intensity);\n        });\n\n        this.velocityX = 0;\n        this.velocityY = 0;\n\n        this.loadPlayerSpec();\n    }\n\n    // No longer used; could be removed?\n    loadPlayerSpec() {\n        let loader = new PIXI.loaders.Loader();\n        loader.add('playerSpec', 'public/assets/player/player.yaml');\n        loader.load((loader, resources) => {\n            this.playerSpec = yaml.safeLoad(resources.playerSpec.data);\n        });\n        loader.onComplete.add(() => {});\n    }\n\n    makeAnimation(dir, idx) {\n        let frames = [];\n        for (let i of idx) {\n            // magically works since the spritesheet was loaded with the pixi loader\n            frames.push(PIXI.Texture.fromFrame('penguin_'+ dir + i + '.png'));\n        }\n        return frames;\n    }\n\n    keyboardTick(delta, world) {\n        if (this.movementLocked) {\n            // If movement is locked don't let the keyboard events\n            // do anything\n            return;\n        }\n\n        const moveBy = delta * MOVE_PER_TICK;\n\n        let hasMoved = false;\n\n        let frames = this.sprite.textures;\n\n        this.velocityX = this.velocityX * 0.2;\n        this.velocityY = this.velocityY * 0.2;\n\n        if (this.moveDown.isKeyDown) {\n            this.velocityY += moveBy;\n            hasMoved = true;\n            frames = this.animationFrames.f;\n        }\n        if (this.moveUp.isKeyDown) {\n            this.velocityY -= moveBy;\n            hasMoved = true;\n            frames = this.animationFrames.b;\n        }\n        let newY = this.sprite.y + this.velocityY;\n        if (world.isPositionOkay(this.sprite.x, newY)) {\n            this.sprite.y = newY;\n        }\n\n        if (this.moveLeft.isKeyDown) {\n            this.velocityX -= moveBy;\n            hasMoved = true;\n            frames = this.animationFrames.r;\n        }\n        if (this.moveRight.isKeyDown) {\n            this.velocityX += moveBy;\n            hasMoved = true;\n            frames = this.animationFrames.l;\n        }\n        let newX = this.sprite.x + this.velocityX;\n        if (world.isPositionOkay(newX, this.sprite.y)) {\n            this.sprite.x = newX;\n        }\n\n        if (hasMoved) {\n            this.stepTimer += delta;\n\n            // Update the animation\n            if (this.sprite.textures !== frames) {\n                this.sprite.textures = frames;\n            }\n            this.sprite.play();\n            EE.emit(E_PLAYER_MOVED, new PlayerMovedContext(this.sprite.x, this.sprite.y));\n        } else {\n            this.stepTimer += delta;\n            this.sprite.stop();\n        }\n\n        this.updateEnergy(hasMoved)\n        console.log(\"Metabolic rate:\", this.metabolicRate);\n    }\n\n    updateEnergy(hasMoved) {\n        let energyToBurn = -STEP_HUNGER_REMOVAL * this.metabolicRate;\n\n        if (!this.shouldBurnEnergy) {\n            return;\n        }\n        if (this.stepTimer <= STEP_HUNGER_TIME) {\n            return;\n        }\n\n        if (!hasMoved) {\n            energyToBurn *= IDLE_ENERGY_BURN;\n        }\n\n        EE.emit(E_ADD_HUNGER, energyToBurn);\n        this.stepTimer = 0;\n    }\n\n    getLocation() {\n        return {\n            'x': this.sprite.x,\n            'y': this.sprite.y\n        };\n    }\n\n    setLocation(x, y) {\n        this.sprite.x = x;\n        this.sprite.y = y;\n    }\n\n    getX() {\n        return this.sprite.x;\n    }\n\n    getY() {\n        return this.sprite.y;\n    }\n\n    collidesWith(entity) {\n        return collidesWith(entity, this.sprite.x, this.sprite.y);\n    }\n}\n","import * as PIXI from 'pixi.js';\n\nimport {\n    KeyboardEventHandler,\n    KEY_SPACE,\n} from \"./keyboard\";\n\nconst TEXT_PADDING = 20;\nconst BOX_MARGIN = 20;\n\nexport class TextPrompt {\n    constructor(text, x, y, w, h, conf, parentContainer, finishCallback, speakerName) {\n        this.textLen = 0;\n        this.text = text;\n        this.timer = 0;\n        this.speakerName = speakerName;\n\n        this.finishCallback = finishCallback;\n\n        this.dismissHandler = new KeyboardEventHandler(KEY_SPACE);\n\n        this.container = new PIXI.Container();\n\n        this.textComponent = new PIXI.Text('', new PIXI.TextStyle({\n            fontFamily: 'Tahoma',\n            fontSize: 28,\n            wordWrap: true,\n            wordWrapWidth: w - TEXT_PADDING*2 - BOX_MARGIN*2\n        }));\n\n        this.textComponent.x = x + TEXT_PADDING + BOX_MARGIN;\n        this.textComponent.y = y + TEXT_PADDING + BOX_MARGIN;\n\n        let graphics = TextPrompt._makeBackground(x, y, w, h);\n        this.readyPrompt = TextPrompt._makeReadyPrompt(x, y, w, h);\n\n        this.container.addChild(graphics);\n        this.container.addChild(this.textComponent);\n\n        if (conf.character) {\n            let par = PIXI.loader.resources[conf.character].texture;\n            let sprite = new PIXI.Sprite(par);\n            sprite.scale.x = 0.5;\n            sprite.scale.y = 0.5;\n            sprite.x = BOX_MARGIN;\n            if (conf.flipSide) {\n                sprite.scale.x = -0.5;\n                sprite.x = x - BOX_MARGIN + w;\n            }\n            sprite.y = y-sprite.height+BOX_MARGIN;\n            this.container.addChild(sprite);\n        }\n\n        this.parentContainer = parentContainer;\n        parentContainer.addChild(this.container);\n\n        this.dismissHandler.bindListeners();\n        this.ticker = this.ticker.bind(this);\n    }\n\n    static _makeBackground(x, y, w, h) {\n        let graphics = new PIXI.Graphics();\n        graphics.lineStyle(5, 0xFFFFFF, 1);\n        graphics.beginFill(0xFFFFFF, 0.8);\n        graphics.drawRoundedRect(x+BOX_MARGIN, y+BOX_MARGIN, w-BOX_MARGIN*2, h-BOX_MARGIN*2, 10);\n        graphics.endFill();\n        return graphics;\n    }\n\n    static _makeReadyPrompt(x, y, w, h) {\n        let readyPrompt = new PIXI.Graphics();\n        readyPrompt.lineStyle(0);\n        readyPrompt.beginFill(0x222255, 0.5);\n        readyPrompt.drawRoundedRect(x+w-TEXT_PADDING-40, y+h-TEXT_PADDING-40, 20, 20, 4);\n        readyPrompt.endFill();\n        return readyPrompt;\n    }\n\n    onFinish() {\n        this.finishCallback && this.finishCallback();\n        this.parentContainer.removeChild(this.container);\n    }\n\n    getTextStringWithSpeaker(substr) {\n        let text = '';\n\n        if (this.speakerName) {\n            text = this.speakerName + ': ';\n        }\n\n        text = text + this.text.substr(0, substr);\n        return text;\n    }\n\n    ticker(delta) {\n        this.timer += delta;\n        if (this.timer > 1) {\n            this.textLen += 1;\n        }\n\n        // Don't add characters if we've reached it\n        if (!this.finished && this.timer > 1) {\n            this.textComponent.text = this.getTextStringWithSpeaker(this.textLen);\n            this.timer = 0;\n\n            if (this.textLen >= this.text.length) {\n                this.finished = true;\n            }\n        } else if (this.timer > 20) {\n            if (!this._hasprompt) {\n                this.container.addChild(this.readyPrompt);\n                this._hasprompt = true;\n            } else {\n                this.container.removeChild(this.readyPrompt);\n                this._hasprompt = false;\n            }\n            this.timer = 0;\n        }\n\n        if (this.dismissHandler.isKeyDown && !this.flopped) {\n            this.flopped = true;\n            if (!this.finished) {\n                this.textLen = this.text.length;\n            } else {\n                this.onFinish();\n            }\n        }\n        // This is a bit rubbish\n        if (this.dismissHandler.isKeyUp) {\n            this.flopped = false;\n        }\n    }\n}\n","import * as PIXI from \"pixi.js\";\nimport { GameApp } from \"./index\";\n\nexport class Slide {\n    // w and h here are the size of the window\n    constructor(image, parentContainer, worldContainer, conf, finishCallback) {\n        this.image = image;\n        this.parentContainer = parentContainer;\n        this.worldContainer = worldContainer;\n        this.conf = conf;\n        this.finishCallback = finishCallback;\n\n        this.setupContainer();\n\n        if (conf.events) {\n            this.runEvents(conf.events, () => {\n                // If we have no hitboxes, remove the slide\n                if (!conf.hitboxes) {\n                    this.finishCallback && this.finishCallback();\n                    this.parentContainer.removeChild(this.container);\n                }\n            });\n        }\n    }\n\n    setupContainer() {\n        this.container = new PIXI.Container();\n\n        let par = PIXI.loader.resources[this.image].texture;\n        this.sprite = new PIXI.Sprite(par);\n        this.sprite.x = GameApp.renderer.width/2;\n        this.sprite.y = GameApp.renderer.height/2;\n        this.sprite.anchor.set(0.5, 0.5);\n        this.container.addChild(this.sprite);\n\n        let startX = GameApp.renderer.width/2 - this.sprite.width / 2;\n        let startY = GameApp.renderer.height/2 - this.sprite.height / 2;\n\n        for (let hitbox of this.conf.hitboxes || []) {\n            let check = hitbox.showIf;\n            let show = !check ? true :\n                this.worldContainer.doCheck(check.key, check.check, check.case);\n\n            let hitboxarea = new PIXI.Graphics();\n            hitboxarea.beginFill(0x000000, 1);\n            hitboxarea.drawRoundedRect(startX+hitbox.x, startY+hitbox.y, hitbox.w, hitbox.h, 10);\n            hitboxarea.endFill();\n            hitboxarea.interactive = true;\n            hitboxarea.alpha = show ? 0.25 : 0;\n            hitboxarea.on('mousedown', () => this.triggerEvent(hitbox.events));\n            hitboxarea.on('mouseover', () => hitboxarea.alpha = 0.1);\n            hitboxarea.on('mouseout', () => hitboxarea.alpha = show ? 0.25 : 0);\n\n            this.container.addChild(hitboxarea);\n        }\n        this.parentContainer.addChild(this.container);\n    }\n\n    runEvents(events, callback) {\n        this.disabled = true;\n        this.finishCallback && this.finishCallback(events, (aborted) => {\n            this.disabled = false;\n            if (callback) {\n                callback(aborted);\n            }\n        });\n    }\n\n    triggerEvent(events){\n        if (this.disabled) {\n            return;\n        }\n        console.log('clicked on hitbox', events);\n        if (events) {\n            this.runEvents(events, (aborted) => {\n                this.parentContainer.removeChild(this.container);\n                if (aborted) {\n                    this.finishCallback && this.finishCallback();\n                    return;\n                }\n                this.setupContainer();\n            });\n        } else {\n            this.finishCallback && this.finishCallback();\n            this.parentContainer.removeChild(this.container);\n        }\n    }\n\n    ticker(delta){}\n}","import Config from \"./config\";\nimport { KeyboardEventHandler, KEY_ESCAPE } from \"./keyboard\";\nimport { TextPrompt } from \"./textprompt\";\nimport EE, {\n    E_ABORT_EVENT_FLOW, E_RUN_EVENTS, E_SET_WORLD_LOCK,\n    E_START_QUEUING_EVENTS, E_STOP_QUEUING_EVENTS\n} from \"./events\";\nimport { Slide } from \"./slide\";\n\nclass EventQueue {\n    constructor() {\n        this.eventQueue = [];\n    }\n\n    queueEvents(eventSpec, onDone) {\n        this.eventQueue.push({\n            'eventSpec': eventSpec,\n            'onDone': onDone\n        });\n    }\n\n    dispatchQueuedEvents(dispatcher) {\n        let queuedEvents = this.eventQueue;\n        this.eventQueue = [];\n        for (let ev of queuedEvents) {\n            dispatcher(ev.eventSpec, ev.onDone);\n        }\n    }\n}\n\nexport class ActionEventHandler {\n    constructor(w, h, uiContainer, worldContainer) {\n        this.worldWidth = w;\n        this.worldHeight = h;\n        this.uiContainer = uiContainer;\n        this.worldContainer = worldContainer;\n\n        // every event stream invocation gets a key issued from this\n        // monotonically-increasing counter. We can use the key to verify a\n        // stream should continue. When events should abort, we drop all the\n        // currently-running event streams and future callbacks should quite\n        // early.\n        this.currentEventKey = 0;\n\n        this.tickers = [];\n\n        // the list of current running event keys. List because event streams\n        // can be nested.\n        this.currentEventKeys = [];\n\n        this.queueEvents = false;\n        this.eventQueue = new EventQueue();\n\n        EE.on(E_ABORT_EVENT_FLOW, () => {\n            this.currentEventKeys = [];\n        });\n        EE.on(E_START_QUEUING_EVENTS, () => {\n            this.queueEvents = true;\n        });\n        EE.on(E_STOP_QUEUING_EVENTS, () => {\n            this.queueEvents = false;\n            this.abortingFlow = false;\n            this._dispatchQueuedEvents();\n        });\n\n        EE.on(E_RUN_EVENTS, (data, onDone) => {\n            this.runEvents(data, onDone);\n        });\n\n        // Allow the ESC key to abort event flow prematurely when debug mode is\n        // active\n        new KeyboardEventHandler(\n            KEY_ESCAPE,\n            () => {\n                console.log(\"got escape key\");\n                Config.debug && EE.emit(E_ABORT_EVENT_FLOW);\n            }\n        ).bindListeners();\n    }\n\n    // Internal event runner, bypasses the queue\n    _runEvents(eventSpec, onDone, key) {\n        EE.emit(E_SET_WORLD_LOCK, true);\n\n        if (this.currentEventKeys.indexOf(key) <= -1) {\n            this.currentEventKeys.push(key);\n        }\n\n        let events = this.loadEvents(eventSpec);\n        let doEvent = (index) => {\n            console.log('EVENT:', events[index]);\n            const shouldAbort = this._shouldAbortEvent(key);\n            if (!events[index] || shouldAbort) {\n                EE.emit(E_SET_WORLD_LOCK, false);\n                onDone(shouldAbort);\n                return;\n            }\n            events[index](() => doEvent(index+1));\n        };\n        doEvent(0);\n    }\n\n    _getEventKey() {\n        return this.currentEventKey++;\n    }\n\n    _shouldAbortEvent(key) {\n        return this.currentEventKeys.indexOf(key) == -1;\n    }\n\n    runEvents(eventSpec, onDone) {\n        if (this.queueEvents) {\n            this.eventQueue.queueEvents(eventSpec, onDone);\n            return;\n        }\n        this._runEvents(eventSpec, onDone, this._getEventKey());\n    }\n\n    _dispatchQueuedEvents() {\n        this.eventQueue.dispatchQueuedEvents(this._runEvents.bind(this));\n    }\n\n    loadEvents(eventSpec) {\n        let eventChain = [];\n        for (let event of eventSpec) {\n            let eventHandler = this.makeEventHandler(event);\n            if (eventHandler) {\n                eventChain.push(eventHandler);\n            } else {\n                console.error('unknown event handler:', eventHandler);\n            }\n        }\n        return eventChain;\n    }\n\n    makeEventHandler(event) {\n        switch (event.type) {\n        case 'text':\n            return this.newTextHandler(event);\n        case 'slide':\n            return this.newSlideHandler(event);\n        case 'event':\n            return this.newEventDispatcher(event);\n        case 'check':\n            return this.newCheck(event);\n        case 'quit':\n            return this.newQuitEventFlow(event);\n        case 'delay':\n            return this.newDelayEventsFlow(event);\n        }\n        return null;\n    }\n\n    newCheck(event) {\n        return (onFinish) => {\n            let ok = this.worldContainer.doCheck(event.key, event.check, event.case);\n            if (!ok) {\n                this._runEvents(event.events, onFinish, this._getEventKey());\n            } else {\n                onFinish();\n            }\n        };\n    }\n\n    newDelayEventsFlow(event) {\n        return (finishCallback) => {\n            let alreadyFinished = false;\n            let onFinish = () => {\n                (!alreadyFinished) && finishCallback();\n                alreadyFinished = true;\n            };\n\n            let callback = () => {\n                if (event.events) {\n                    this._runEvents(event.events, () => {}, this._getEventKey());\n                }\n                onFinish();\n            };\n\n            if (event.async) {\n                // Surprise! We're async. Dispatch the \"finish\" event\n                // immediately so we move to the next one\n                onFinish();\n            }\n\n            window.setTimeout(callback, event.content * 1000);\n        };\n    }\n\n    newTextHandler(event) {\n        return (onFinish) => {\n            let prompt;\n            let finishHandler = () => {\n                const index = this.tickers.indexOf(prompt);\n                this.tickers.splice(index, 1);\n                onFinish();\n            };\n            prompt = new TextPrompt(\n                event.text,\n                0, this.worldHeight - 200, this.worldWidth, 200,\n                event, this.uiContainer, finishHandler,\n                event.speaker_name\n            );\n            this.tickers.push(prompt);\n            return prompt;\n        };\n    }\n\n    newSlideHandler(event) {\n        return (onFinish) => {\n            let slide;\n            let finishHandler = (events, done) => {\n                if (!events) {\n                    const index = this.tickers.indexOf(slide);\n                    this.tickers.splice(index, 1);\n                    onFinish();\n                } else {\n                    this._runEvents(events, done, this._getEventKey());\n                }\n            };\n            slide = new Slide(\n                event.image, this.uiContainer, this.worldContainer,\n                event, finishHandler\n            );\n            this.tickers.push(slide);\n            return slide;\n        };\n    }\n\n    newEventDispatcher(event) {\n        return (onFinish) => {\n            EE.emit(event.event, event.content);\n            onFinish();\n        };\n    }\n\n    newQuitEventFlow(event) {\n        return (onFinish) => {\n            EE.emit(E_ABORT_EVENT_FLOW);\n            onFinish();\n        };\n    }\n\n    ticker(delta) {\n        for (let ticker of this.tickers) {\n            ticker.ticker(delta);\n        }\n    }\n}\n","import * as PIXI from \"pixi.js\";\nimport EE, { E_ADD_HUNGER, E_RUN_EVENTS } from \"./events\";\n\nexport class HungerMeter {\n    constructor() {\n        this.hunger = 100;\n\n        this.container = new PIXI.Container();\n\n        let graphics = new PIXI.Graphics();\n        graphics.lineStyle(4, 0xFFFFFF, 1);\n        graphics.beginFill(0xFFFFFF, 0.8);\n        graphics.drawRoundedRect(80, 20, 200, 30, 5);\n        graphics.endFill();\n\n        this.container.addChild(graphics);\n        this.setBar();\n\n        let fishIcon = new PIXI.Sprite(PIXI.loader.resources['fish'].texture);\n        fishIcon.anchor.set(0.5);\n        fishIcon.x = 40;\n        fishIcon.y = 35;\n        fishIcon.scale.x = 0.7;\n        fishIcon.scale.y = 0.7;\n        fishIcon.rotation = -Math.PI / 7;\n        this.container.addChild(fishIcon);\n\n        EE.on(E_ADD_HUNGER, (diff) => {\n            this.addHunger(diff);\n        });\n    }\n\n    setBar() {\n        if (this.bar) {\n            this.container.removeChild(this.bar);\n        }\n        this.bar = new PIXI.Graphics();\n\n        let colour = 0xFFA500;\n        if (this.hunger < 25) {\n            colour = 0xFF0000;\n        }\n        this.bar.beginFill(colour, 0.8);\n        this.bar.drawRoundedRect(80, 20,\n            200 * (this.hunger / 100),\n            30, 5);\n        this.bar.endFill();\n\n        this.container.addChild(this.bar);\n    }\n\n    getComponent() {\n        return this.container;\n    }\n\n    addHunger(diff) {\n        this.hunger += diff;\n        if (this.hunger > 100) {\n            this.hunger = 100;\n        }\n\n        if (this.hunger <= 0) {\n            this.hunger = 0;\n            // TODO: we should do something better?\n            EE.emit(E_RUN_EVENTS, [{\n                type: 'text',\n                text: 'You have run out of food!',\n            }, {\n                type: 'slide',\n                image: 'black_slide',\n                events: [{\n                    type: 'text',\n                    text: '...                                \\nTux blacked out.' // Oh yeah >:)\n                }]\n            }], () => {\n                this.hunger = 100;\n                this.setBar();\n            });\n        } else {\n            this.setBar();\n        }\n    }\n}","import * as PIXI from \"pixi.js\";\nimport {Emitter} from \"pixi-particles\";\n\nimport EE, { E_SET_WEATHER_INTENSITY } from \"./events\";\nimport { GameApp } from \"./index\";\n\nlet snowEmitter;\n\nexport function newSnow(container) {\n    // Create a new emitter\n    snowEmitter = new Emitter(\n        container,\n        [PIXI.loader.resources['snow'].texture],\n\n        // Emitter configuration, edit this to change the look\n        // of the emitter\n        {\n            \"alpha\": {\n                \"start\": 1,\n                \"end\": 0\n            },\n            \"scale\": {\n                \"start\": 0.2,\n                \"end\": 0.2,\n                \"minimumScaleMultiplier\": 1\n            },\n            \"color\": {\n                \"start\": \"#ffffff\",\n                \"end\": \"#ffffff\"\n            },\n            \"speed\": {\n                \"start\": 50,\n                \"end\": 50,\n                \"minimumSpeedMultiplier\": 0.001\n            },\n            \"acceleration\": {\n                \"x\": 0,\n                \"y\": 0\n            },\n            \"maxSpeed\": 0,\n            \"startRotation\": {\n                \"min\": 40,\n                \"max\": 50\n            },\n            \"noRotation\": true,\n            \"rotationSpeed\": {\n                \"min\": 0,\n                \"max\": 0\n            },\n            \"lifetime\": {\n                \"min\": 3,\n                \"max\": 6\n            },\n            \"blendMode\": \"normal\",\n            \"frequency\": 0.01,\n            \"emitterLifetime\": -1,\n            \"maxParticles\": 500,\n            \"pos\": {\n                \"x\": 0,\n                \"y\": 0\n            },\n            \"addAtBack\": false,\n            \"spawnType\": \"rect\",\n            \"spawnRect\": {\n                \"x\": 0,\n                \"y\": 0,\n                \"w\": GameApp.renderer.width,\n                \"h\": GameApp.renderer.height\n            }\n        }\n    );\n\n    // Start emitting\n    snowEmitter.emit = true;\n\n    let time = 1000;\n\n    // Update function every frame\n    return function (delta) {\n        time += delta;\n\n        // The snowEmitter requires the elapsed\n        // number of seconds since the last update\n        snowEmitter.update(time * 0.0001);\n    };\n}\n\nEE.on(E_SET_WEATHER_INTENSITY, (intensity) => {\n    snowEmitter.maxParticles = intensity * 50000;\n    snowEmitter.spawnChance = intensity;\n\n    snowEmitter.minimumSpeedMultiplier = intensity;\n});\n","import * as PIXI from \"pixi.js\";\nimport EE, {\n    E_SET_GLOBAL,\n    E_SET_TEMPRATURE,\n    E_SET_WEATHER_INTENSITY\n} from \"./events\";\n\nexport class Thermometer {\n    constructor() {\n        this.temperature = 50;\n\n        this.container = new PIXI.Container();\n\n        let graphics = new PIXI.Graphics();\n        graphics.lineStyle(3, 0xFFFFFF, 1);\n        graphics.beginFill(0xFFFFFF, 0.8);\n        graphics.drawRoundedRect(80, 70, 200, 15, 7.5);\n        graphics.endFill();\n\n        graphics.lineStyle(3, 0xFFFFFF, 1);\n        graphics.beginFill(0xFF0000, 1);\n        graphics.drawCircle(93, 77.5, 15);\n        graphics.endFill();\n\n        this.container.addChild(graphics);\n        this.setBar();\n\n        let thermoIcon = new PIXI.Sprite(PIXI.loader.resources['thermo'].texture);\n        thermoIcon.anchor.set(0.5);\n        thermoIcon.x = 40;\n        thermoIcon.y = 79;\n        thermoIcon.scale.x = 0.7;\n        thermoIcon.scale.y = 0.7;\n        this.container.addChild(thermoIcon);\n\n        EE.on(E_SET_TEMPRATURE, (temp) => {\n            this.setTemperature(temp);\n        });\n        EE.on(E_SET_WEATHER_INTENSITY, intensity => {\n            this.temperature = 20 + (50-intensity*50);\n            this.setBar();\n        });\n\n        this.container.alpha = 0;\n        EE.on(E_SET_GLOBAL, (vals) => {\n            if (vals.keys === 'thermometer' && vals.value) {\n                this.container.alpha = 1;\n            }\n        });\n    }\n\n    setBar() {\n        if (this.bar) {\n            this.container.removeChild(this.bar);\n        }\n        this.bar = new PIXI.Graphics();\n\n        this.bar.beginFill(0xFF0000, 1);\n        this.bar.drawRoundedRect(80, 71,\n            200 * (this.temperature / 100),\n            14, 7.5);\n\n        this.container.addChild(this.bar);\n    }\n\n    getComponent() {\n        return this.container;\n    }\n\n    setTemperature(value) {\n        this.temperature = value;\n        this.setBar();\n    }\n}","import '../styles/index.scss';\nimport * as PIXI from 'pixi.js';\nimport yaml from \"js-yaml\";\n\nimport { BackpackBar } from \"./backpack\";\nimport { Character } from \"./character\";\nimport EE, {\n    E_ENTITY_DISPATCH_ACTIONS,\n    E_GO_TO_WORLD,\n    E_PLAYER_MOVED, E_SET_WEATHER_INTENSITY,\n    E_DID_UPDATE_BACKPACK_CONTENTS,\n} from \"./events\";\nimport { WorldContainer, tileToGlobal } from \"./world\";\nimport { ActionEventHandler } from \"./actionEvents\";\n\nimport { LOCAL_DEFAULT_WORLD_ID } from \"./localsettings\";\nimport { HungerMeter } from \"./hunger\";\nimport { newSnow } from \"./particles\";\nimport { Thermometer } from \"./thermometer\";\n\nconst DEFAULT_WORLD_ID = LOCAL_DEFAULT_WORLD_ID || 4;\n\nfunction getBackground(texture, width, height) {\n    let tilingBackground = new PIXI.extras.TilingSprite(\n        texture, width, height\n    );\n    tilingBackground.anchor.set(0.5);\n    tilingBackground.tileScale.set(0.5);\n    return tilingBackground;\n}\n\nfunction getClouds(texture, width, height) {\n    let tilingBackground = new PIXI.extras.TilingSprite(\n        texture, width, height\n    );\n    tilingBackground.anchor.set(0.5);\n    tilingBackground.tileScale.set(2);\n    tilingBackground.alpha = 0.2;\n\n    EE.on(E_SET_WEATHER_INTENSITY, intensity => {\n        tilingBackground.alpha = intensity;\n    });\n\n    // console.log(PIXI.BLEND_MODES);\n    tilingBackground.blendMode = PIXI.BLEND_MODES['SCREEN'];\n    return tilingBackground;\n}\n\nexport const FULL_WIDTH = false;\n\nexport const GameApp = new PIXI.Application(\n    FULL_WIDTH ? window.innerWidth : 1024,\n    FULL_WIDTH ? window.innerHeight : 768,\n    {backgroundColor: 0x1099bb}\n);\n\nlet backpack = new Set();\n\nfunction initGame(loader, resources) {\n    console.log(resources);\n    document.body.appendChild(GameApp.view);\n\n    let background = getBackground(\n        resources['sea_background'].texture,\n        window.innerWidth * 10,\n        window.innerHeight * 10\n    );\n    GameApp.stage.addChild(background);\n    let bgTicker = 0;\n    GameApp.ticker.add(t => {\n        bgTicker += t;\n        background.x = Math.sin(bgTicker/200) * 32;\n        background.y = Math.cos(bgTicker/125) * 32;\n\n        background.scale.x = 1 + Math.sin(bgTicker/500) * 0.04;\n        background.scale.y = 1 + Math.cos(bgTicker/400) * 0.04;\n    });\n\n    let uiContainer = new PIXI.Container();\n\n    let worldContainer = new WorldContainer(uiContainer);\n    GameApp.stage.addChild(worldContainer.container);\n\n    let character = new Character(backpack);\n    GameApp.stage.addChild(character.container);\n\n    worldContainer.registerWorldChangeCallback((world) => {\n        const startingPosition = world.getStartingPosition();\n        character.setLocation(\n            tileToGlobal(startingPosition.x),\n            tileToGlobal(startingPosition.y)\n        );\n    });\n\n    // Add the clouds\n    let clouds = getClouds(\n        resources['cloud'].texture,\n        window.innerWidth * 10,\n        window.innerHeight * 10\n    );\n    GameApp.stage.addChild(clouds);\n\n    let snowEmitter = newSnow(uiContainer);\n    GameApp.ticker.add(snowEmitter);\n\n    let hungerMeter = new HungerMeter();\n    uiContainer.addChild(hungerMeter.getComponent());\n\n    let backpackBar = new BackpackBar();\n    let backpackComponent = backpackBar.getComponent();\n    uiContainer.addChild(backpackComponent);\n    EE.on(E_DID_UPDATE_BACKPACK_CONTENTS, () => {\n        backpackBar.renderBackpack(character.backpack);\n        backpackComponent.x = (\n            GameApp.renderer.width - backpackComponent.width\n        );\n    });\n\n    let thermometer = new Thermometer();\n    uiContainer.addChild(thermometer.getComponent());\n\n    let eventHandler = new ActionEventHandler(\n        GameApp.screen.width,\n        GameApp.screen.height,\n        uiContainer,\n        worldContainer\n    );\n    EE.on(E_ENTITY_DISPATCH_ACTIONS, (context) => { eventHandler.runEvents(context, () => {}); });\n\n    GameApp.stage.addChild(uiContainer);\n\n    // Text prompt update\n    GameApp.ticker.add(t => {\n        eventHandler.ticker(t);\n    });\n\n    let par = PIXI.loader.resources['vignette'].texture;\n    let vignette = new PIXI.Sprite(par);\n    vignette.width = GameApp.renderer.width;\n    vignette.height = GameApp.renderer.height;\n    GameApp.stage.addChild(vignette);\n\n    // Character position updates\n    GameApp.ticker.add(t => {\n        worldContainer.world.ticker(t, character);\n        character.keyboardTick(t, worldContainer.world);\n        GameApp.stage.pivot.x = character.getX() - GameApp.renderer.width / 2;\n        GameApp.stage.pivot.y = character.getY() - GameApp.renderer.height / 2;\n\n        worldContainer.doDetectCollisions(character.sprite.x, character.sprite.y);\n\n        let xx = character.getX() - GameApp.renderer.width / 2;\n        let yy = character.getY() - GameApp.renderer.height / 2;\n        uiContainer.x = xx;\n        uiContainer.y = yy;\n        vignette.x = xx;\n        vignette.y = yy;\n    });\n\n    window.setWorld = (worldId) => { EE.emit(E_GO_TO_WORLD, worldId); };\n}\n\nfunction start() {\n    EE.emit(E_GO_TO_WORLD, DEFAULT_WORLD_ID);\n}\n\nfunction loadRootAssets() {\n    PIXI.loader\n        .add('sea_background', 'public/assets/sea.png')\n        .add('public/assets/penguin/penguin2.json')\n        .add('scratchcat', 'public/assets/sprites/scratchcat.png')\n        .add('berg', 'public/assets/sprites/berg.png')\n        .add('fish', 'public/assets/sprites/fish.png')\n        .add('thermo', 'public/assets/sprites/thermo.png')\n        .add('berg_big', 'public/assets/sprites/berg_big.png')\n        .add('walrus', 'public/assets/sprites/walrus.png')\n        .add('bear', 'public/assets/sprites/bear.png')\n        .add('iceicebaby', 'public/assets/sprites/iceicebaby.jpg')\n        .add('tuxside', 'public/assets/penguin/tux_side.png')\n        .add('walrusside', 'public/assets/penguin/walrus_side.png')\n        .add('bearside', 'public/assets/penguin/bear_side.png')\n        .add('piratewalrusside', 'public/assets/penguin/pirate_walrus_side.png')\n        .add('water_slide', 'public/assets/slides/water_slide.png')\n        .add('snow_slide', 'public/assets/slides/snow_slide.png')\n        .add('brochure', 'public/assets/slides/brochure.png')\n        .add('select_items', 'public/assets/slides/select_items.png')\n        .add('vignette', 'public/assets/vignette.png')\n        .add('snow', 'public/assets/particles/snow.png')\n        .add('cloud', 'public/assets/particles/cloud.png')\n        .add('splash', 'public/assets/slides/splash.png')\n        .add('ice_1_slide', 'public/assets/slides/ice_1_slide.png')\n        .add('ice_2_slide', 'public/assets/slides/ice_2_slide.png')\n        .add('sepia', 'public/assets/slides/sepia.png')\n        .add('black_slide', 'public/assets/slides/black_slide.png')\n        .add('empty', 'public/assets/sprites/empty.png')\n        .add('station', 'public/assets/sprites/station.png')\n        .add('station2', 'public/assets/sprites/station2.png')\n        .add('tent', 'public/assets/sprites/tent.png')\n        .load((loader, resources) => {\n            initGame(loader, resources);\n            start();\n        });\n}\n\nlet worldLoader = new PIXI.loaders.Loader();\nworldLoader.add('worlds', 'public/assets/worlds/worlds.yaml');\nworldLoader.load((loader, resources) => {\n    const worlds = yaml.safeLoad(resources['worlds'].data);\n    for (let world of worlds) {\n        PIXI.loader\n            .add('world' + world + '_spec', 'public/assets/worlds/world' + world + '.yaml')\n            .add('world' + world + '_tiles', 'public/assets/worlds/world' + world + '.csv');\n    }\n});\nworldLoader.onComplete.add(() => { loadRootAssets(); });\n","export const LOCAL_DEFAULT_WORLD_ID = '_splash';"],"sourceRoot":""}