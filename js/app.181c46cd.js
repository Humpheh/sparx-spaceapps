!function(e){function t(t){for(var s,a,o=t[0],h=t[1],l=t[2],c=0,p=[];c<o.length;c++)a=o[c],n[a]&&p.push(n[a][0]),n[a]=0;for(s in h)Object.prototype.hasOwnProperty.call(h,s)&&(e[s]=h[s]);for(d&&d(t);p.length;)p.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],s=!0,o=1;o<i.length;o++){var h=i[o];0!==n[h]&&(s=!1)}s&&(r.splice(t--,1),e=a(a.s=i[0]))}return e}var s={},n={0:0},r=[];function a(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=s,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window.webpackJsonp=window.webpackJsonp||[],h=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=h;r.push([230,1]),i()}({102:function(e,t,i){},230:function(e,t,i){"use strict";i.r(t);i(102);var s=i(0),n=i(14),r=i.n(n);class a{constructor(){this.container=new s.Container,this.container.width=100}getComponent(){return this.container}renderBackpack(e){this.container.removeChildren();for(let t of function(e){let t=[];for(let i of e)t.push(new s.Sprite(s.loader.resources[i].texture));return t}(e))this.container.addChild(t)}}var o=i(99),h={debug:!0};const l="PLAYER_MOVED",d="SET_WORLD_LOCK",c="ENTITY_DISPATCH_ACTIONS",p="DESTROY_ENTITY",u="SET_GLOBAL",w="INC_GLOBAL",m="APPEND_GLOBAL",g="DEPEND_GLOBAL",v="GO_TO_WORLD",y="ABORT_EVENT_FLOW",b="START_QUEUING_EVENTS",f="STOP_QUEUING_EVENTS",C="ADD_HUNGER",k="RUN_EVENTS",x="SET_WEATHER_INTENSITY",E="ADD_BACKPACK_ITEM",_="DID_UPDATE_BACKPACK_CONTENTS",S="SET_TEMPERATURE",T="SET_CHARACTER_OPACITY",L="REQUEST_PLACE_ENTITY",R="E_SET_ENTITY_POSITION";let A=new(i.n(o).a);function D(e){A.on(e,()=>{console.log("Received event: "+e)})}h.debug&&(D(d),D(c),D(p),D(u),D(w),D(m),D(g),D(v),D(y),D(b),D(f),D(C),D(k),D(x),D(E),D(_),D(S),D(T),D(L),D(R),D("SET_METABOLIC_RATE"));var P=A;const O=40,M=38,K=37,F=39,I=32,W=27;class H{constructor(e,t=null,i=null){Object.assign(this,{isKeyDown:!1,isKeyUp:!0}),this.allowRepeat=!0,this.keyCode=e,this.oneShot=!1,this.everPressed=!1,null!==t&&(this.onPress=t),null!==i&&(this.onRelease=i)}bindListeners(){return window.addEventListener("keydown",this.downHandler.bind(this),!1),window.addEventListener("keyup",this.upHandler.bind(this),!1),this}downHandler(e){e.keyCode===this.keyCode&&(this.everPressed&&this.oneShot||(this.everPressed=!0,!this.allowRepeat&&this.isKeyDown||(this.isKeyDown=!0,this.isKeyUp=!1,this.onPress()),e.preventDefault()))}upHandler(e){e.keyCode===this.keyCode&&(this.isKeyDown=!1,this.isKeyUp=!0,this.onRelease()),e.preventDefault()}onPress(){}onRelease(){}}var N=i(100),B=i.n(N);class Y{constructor(e,t,i,n){this.id=n.id||"ALL_OTHER_ENTITIES",this.entitySpec=n,this.sprite=new s.Sprite(i),this.sprite.anchor.set(.5),this.sprite.x=e*Q,this.sprite.y=t*Q,this.sprite.width=Q*(this.entitySpec.tileScale||1),this.sprite.height=Q*(this.entitySpec.tileScale||1),n.flip&&(this.sprite.width=-this.sprite.width),this.events=n.events,this.dispatchInteractionActions=this.dispatchInteractionActions.bind(this),this.movementLocked=!1,P.on(d,e=>this.movementLocked=e),this.setVisible(n.spawnVisible||void 0===n.spawnVisible)}setVisible(e){this.visible=e,this.sprite.alpha=e?1:0}isWalkable(){return!!this.entitySpec.walkable}dispatchInteractionActions(){this.visible&&this.entitySpec.events&&P.emit(c,this.entitySpec.events)}ticker(e,t){this.entitySpec.move&&this._doMove(e,t)}setLocation(e,t){this.sprite.x=e,this.sprite.y=t}_doMove(e,t){if(this.movementLocked)return;this.moveIndex=this.moveIndex||0;let i=this.entitySpec.moveSpeed||1,s=this.entitySpec.move[this.moveIndex],n=this.sprite.x-s.x*Q,r=this.sprite.y-s.y*Q,a=0,o=0;Math.abs(n)>10&&(a=(n>0?-1:1)*e*i,this.sprite.x+=a),Math.abs(r)>10&&(o=(r>0?-1:1)*e*i,this.sprite.y+=o),t.collidesWith(this)&&(t.sprite.x+=a,t.sprite.y+=o),Math.abs(n)<10&&Math.abs(r)<10&&(this.moveIndex=(this.moveIndex+1)%this.entitySpec.move.length)}}class U extends Y{constructor(e,t){let i=Math.random();super(e,t,s.loader.resources.fish.texture,{id:i,events:[{type:"text",text:"You found a fish! Hunger replenished."},{type:"event",event:C,content:25},{type:"event",event:p,content:i}]}),this.startY=this.sprite.y,this.time=200*Math.random()}ticker(e,t){this.time+=e;let i=Math.sin(this.time/15);i=i>0?0:i,this.sprite.y=this.startY+10*i,this.sprite.rotation=i*Math.PI/10*Math.random()}}const G=0,Q=64,j=.002;let V={ice_m1:["ice_m1","ice_m1a"],ice_m2:["ice_m2","ice_m2a","ice_m2b"],ice_m3:["ice_m3","ice_m3a"]};class q{constructor(e,t,i,s){this.x=e,this.y=t,this.sprite=i.trim()?q.loadSprite(i):null,this.solid=!this.sprite||s,this.sprite&&(this.sprite.anchor.set(.5),this.sprite.x=e*Q,this.sprite.y=t*Q,this.sprite.width=Q,this.sprite.height=Q)}static loadSprite(e){if(V.hasOwnProperty(e)){const t=function(e,t){return Math.floor(Math.random()*(t-e+1))+e}(0,V[e].length-1);e=V[e][t]}const t=s.Texture.fromImage("public/assets/sprites/"+e+".png");return new s.Sprite(t)}}class X{constructor(e){this.container=new s.Container,this.world=[],this.entities=[];let t=this.fileToTileData(e);this.loadWorld(t),this.loadWorldSpec(e),this.inCollision=new Set,P.on(p,e=>{this.entities.forEach((t,i)=>{if(t.id===e){const e=this.entities.indexOf(t);this.entities.splice(e,1),this.container.removeChild(t.sprite)}})}),P.on(L,e=>{console.log("placing entity "+e),this.entities.forEach((t,i)=>{t.id===e&&t.setVisible(!0)})}),P.on(R,({id:e,x:t,y:i})=>{this.entities.forEach((s,n)=>{s.id===e&&s.setLocation(t,i)})})}loadWorld(e){this.world=[];for(let t=0;t<e.length;t++){let i=[];for(let s=0;s<e[t].length;s++){let n=this.createTile(s,t,e[t][s]);n&&Math.random()<j&&this.createFish(s,t),i.push(n)}this.world.push(i)}}createFish(e,t){let i=new U(e,t);this.container.addChild(i.sprite),this.entities.push(i)}loadWorldSpec(e){let t=s.loader.resources["world"+e+"_spec"].data;this.worldSpec=r.a.safeLoad(t),this.placeEntities(this.worldSpec.entities);const i=this.worldSpec.initialWeatherIntensity||G;P.emit(x,i)}fileToTileData(e){let t=s.loader.resources["world"+e+"_tiles"].data,i=t?t.split(/\r\n|\n/):"",n=[];for(let e=0;e<i.length;e++)n.push(i[e].split(","));return n}placeEntities(e){for(let t of e)this.entities.push(new Y(t.x,t.y,s.loader.resources[t.sprite].texture,t)),t.spawnKey&&(void 0===t.id&&B.a.error("Entities with spawnKey must have an id!"),new H(t.spawnKey.charCodeAt(0),()=>{P.emit(L,t.id)}).bindListeners().oneShot=!0);for(let e of this.entities)this.container.addChild(e.sprite)}createTile(e,t,i){let s=i.split(","),n=s[0];if(""===n.trim())return null;let r=s.length>1&&"s"===s[1],a=new q(e,t,n,r);return a.sprite&&this.container.addChild(a.sprite),a}getTile(e,t){return(this.world[t]||[])[e]}isSolid(e,t){let i=this.getTile(e,t);return!i||i.solid}isPositionOkay(e,t){let i=Math.round(e/Q),s=Math.round(t/Q),n=!this.isSolid(i,s);if(n)return n;for(let i of this.entities)if(z(i,e,t)&&i.isWalkable())return!0;return!1}collidesAt(e,t){let i=new Set;for(let s of this.entities)z(s,e,t)&&i.add(s);return i}getStartingPosition(){const e=this.worldSpec.playerStart;return void 0!==e&&e.x&&e.y?e:{x:1,y:1}}updateCollisionStates(e){this.inCollision.forEach(t=>{e.has(t)||this.inCollision.delete(t)}),e.forEach(e=>{this.inCollision.has(e)||(this.inCollision.add(e),e.dispatchInteractionActions())})}doDetectCollisions(e,t){let i=this.collidesAt(e,t);this.updateCollisionStates(i)}ticker(e,t){for(let i of this.entities)i.ticker(e,t)}}class J{constructor(e){this.uiContainer=e,this.values={},this.world=null,this.worldChangeCallbacks=[],this.container=new s.Container,this.registerEventListeners(),P.on(u,e=>{this.values[e.key]=e.value,console.log("setting values",this.values)}),P.on(w,e=>{this.values[e.key]=(this.values[e.key]||0)+e.value,console.log("adding values",this.values)}),P.on(m,e=>{this.values[e.key]=(this.values[e.key]||[]).concat([e.value]),console.log("concat values",this.values)}),P.on(g,e=>{const t=(this.values[e.key]||[]).indexOf(e.value);t&&this.values[e.key].splice(t,1),console.log("depend values",this.values)})}setSepia(e){this.sepia&&!e?this.uiContainer.removeChild(this.sepia):!this.sepia&&e&&(this.sepia=new s.Sprite(s.loader.resources.sepia.texture),this.sepia.x=0,this.sepia.y=0,this.sepia.alpha=.5,this.uiContainer.addChild(this.sepia))}doCheck(e,t,i){let s=this.values[e];if(!s)return!1;switch(i){case"eq":return s==t;case"gt":return s>t;case"lt":return s<t}return console.error("unknown comparator",i),!1}doDetectCollisions(e,t){this.world&&this.world.doDetectCollisions(e,t)}registerWorldChangeCallback(e){this.worldChangeCallbacks.push(e)}registerEventListeners(){P.on(v,e=>this._setWorld(e))}_setWorld(e){console.log("Setting world to: "+e),P.emit(y),P.emit(b),this.world&&(console.log("Removing previous world"),this.container.removeChild(this.world.container)),this.world=new X(e),this.container.addChild(this.world.container),this.setSepia(this.world.worldSpec.sepia),P.emit(T,this.world.worldSpec.hideCharacter?0:1);for(let e of this.worldChangeCallbacks)e(this.world,this);P.emit(f)}}function z(e,t,i){const s=e.sprite.x,n=e.sprite.y,r=e.sprite.width,a=e.sprite.height;return s-r/2<=t&&s+r/2>=t&&(n-a/2<=i&&n+a/2>=i)}function Z(e){return e*Q}const $=3,ee=20,te=1,ie=.2;class se{constructor(e,t){this.x=e,this.y=t}}class ne{constructor(){this.stepTimer=0,this.container=new s.Container,this.metabolicRate=1,this.animationFrames={b:this.makeAnimation("b",[1,2,3,2]),f:this.makeAnimation("f",[1,2,3,2]),l:this.makeAnimation("l",[1,2,3,2]),r:this.makeAnimation("r",[1,2,3,2])},this.backpack=new Set;let e=new s.extras.AnimatedSprite(this.animationFrames.r);e.animationSpeed=.1,e.width=.5*e.width,e.height=.5*e.height,e.anchor.set(.5,.75),e.play(),this.container.addChild(e),this.sprite=e,this.moveDown=new H(O),this.moveUp=new H(M),this.moveLeft=new H(K),this.moveRight=new H(F),this.moveDown.bindListeners(),this.moveUp.bindListeners(),this.moveLeft.bindListeners(),this.moveRight.bindListeners(),this.keyboardTick=this.keyboardTick.bind(this),this.shouldBurnEnergy=!0,this.movementLocked=!1,P.on(d,e=>{this.movementLocked=e,e&&this.sprite.stop()}),P.on(E,e=>{this.backpack.add(e),console.log("BACKPACK: ",this.backpack),P.emit(_)}),P.on(T,e=>{this.sprite.alpha=e,this.shouldBurnEnergy=e>0}),P.on(L,e=>{P.emit(R,{id:e,x:this.sprite.x,y:this.sprite.y})}),P.on(x,e=>{this.metabolicRate=Math.exp(e)}),this.velocityX=0,this.velocityY=0,this.loadPlayerSpec()}loadPlayerSpec(){let e=new s.loaders.Loader;e.add("playerSpec","public/assets/player/player.yaml"),e.load((e,t)=>{this.playerSpec=r.a.safeLoad(t.playerSpec.data)}),e.onComplete.add(()=>{})}makeAnimation(e,t){let i=[];for(let n of t)i.push(s.Texture.fromFrame("penguin_"+e+n+".png"));return i}keyboardTick(e,t){if(this.movementLocked)return;const i=e*$;let s=!1,n=this.sprite.textures;this.velocityX=.2*this.velocityX,this.velocityY=.2*this.velocityY,this.moveDown.isKeyDown&&(this.velocityY+=i,s=!0,n=this.animationFrames.f),this.moveUp.isKeyDown&&(this.velocityY-=i,s=!0,n=this.animationFrames.b);let r=this.sprite.y+this.velocityY;t.isPositionOkay(this.sprite.x,r)&&(this.sprite.y=r),this.moveLeft.isKeyDown&&(this.velocityX-=i,s=!0,n=this.animationFrames.r),this.moveRight.isKeyDown&&(this.velocityX+=i,s=!0,n=this.animationFrames.l);let a=this.sprite.x+this.velocityX;t.isPositionOkay(a,this.sprite.y)&&(this.sprite.x=a),s?(this.stepTimer+=e,this.sprite.textures!==n&&(this.sprite.textures=n),this.sprite.play(),P.emit(l,new se(this.sprite.x,this.sprite.y))):(this.stepTimer+=e,this.sprite.stop()),this.updateEnergy(s),console.log("Metabolic rate:",this.metabolicRate)}updateEnergy(e){let t=-te*this.metabolicRate;this.shouldBurnEnergy&&(this.stepTimer<=ee||(e||(t*=ie),P.emit(C,t),this.stepTimer=0))}getLocation(){return{x:this.sprite.x,y:this.sprite.y}}setLocation(e,t){this.sprite.x=e,this.sprite.y=t}getX(){return this.sprite.x}getY(){return this.sprite.y}collidesWith(e){return z(e,this.sprite.x,this.sprite.y)}}const re=20,ae=20;class oe{constructor(e,t,i,n,r,a,o,h,l){this.textLen=0,this.text=e,this.timer=0,this.speakerName=l,this.finishCallback=h,this.dismissHandler=new H(I),this.container=new s.Container,this.textComponent=new s.Text("",new s.TextStyle({fontFamily:"Tahoma",fontSize:28,wordWrap:!0,wordWrapWidth:n-2*re-2*ae})),this.textComponent.x=t+re+ae,this.textComponent.y=i+re+ae;let d=oe._makeBackground(t,i,n,r);if(this.readyPrompt=oe._makeReadyPrompt(t,i,n,r),this.container.addChild(d),this.container.addChild(this.textComponent),a.character){let e=s.loader.resources[a.character].texture,r=new s.Sprite(e);r.scale.x=.5,r.scale.y=.5,r.x=ae,a.flipSide&&(r.scale.x=-.5,r.x=t-ae+n),r.y=i-r.height+ae,this.container.addChild(r)}this.parentContainer=o,o.addChild(this.container),this.dismissHandler.bindListeners(),this.ticker=this.ticker.bind(this)}static _makeBackground(e,t,i,n){let r=new s.Graphics;return r.lineStyle(5,16777215,1),r.beginFill(16777215,.8),r.drawRoundedRect(e+ae,t+ae,i-2*ae,n-2*ae,10),r.endFill(),r}static _makeReadyPrompt(e,t,i,n){let r=new s.Graphics;return r.lineStyle(0),r.beginFill(2237013,.5),r.drawRoundedRect(e+i-re-40,t+n-re-40,20,20,4),r.endFill(),r}onFinish(){this.finishCallback&&this.finishCallback(),this.parentContainer.removeChild(this.container)}getTextStringWithSpeaker(e){let t="";return this.speakerName&&(t=this.speakerName+": "),t+=this.text.substr(0,e)}ticker(e){this.timer+=e,this.timer>1&&(this.textLen+=1),!this.finished&&this.timer>1?(this.textComponent.text=this.getTextStringWithSpeaker(this.textLen),this.timer=0,this.textLen>=this.text.length&&(this.finished=!0)):this.timer>20&&(this._hasprompt?(this.container.removeChild(this.readyPrompt),this._hasprompt=!1):(this.container.addChild(this.readyPrompt),this._hasprompt=!0),this.timer=0),this.dismissHandler.isKeyDown&&!this.flopped&&(this.flopped=!0,this.finished?this.onFinish():this.textLen=this.text.length),this.dismissHandler.isKeyUp&&(this.flopped=!1)}}class he{constructor(e,t,i,s,n){this.image=e,this.parentContainer=t,this.worldContainer=i,this.conf=s,this.finishCallback=n,this.setupContainer(),s.events&&this.runEvents(s.events,()=>{s.hitboxes||(this.finishCallback&&this.finishCallback(),this.parentContainer.removeChild(this.container))})}setupContainer(){this.container=new s.Container;let e=s.loader.resources[this.image].texture;this.sprite=new s.Sprite(e),this.sprite.x=ve.renderer.width/2,this.sprite.y=ve.renderer.height/2,this.sprite.anchor.set(.5,.5),this.container.addChild(this.sprite);let t=ve.renderer.width/2-this.sprite.width/2,i=ve.renderer.height/2-this.sprite.height/2;for(let e of this.conf.hitboxes||[]){let n=e.showIf,r=!n||this.worldContainer.doCheck(n.key,n.check,n.case),a=new s.Graphics;a.beginFill(0,1),a.drawRoundedRect(t+e.x,i+e.y,e.w,e.h,10),a.endFill(),a.interactive=!0,a.alpha=r?.25:0,a.on("mousedown",()=>this.triggerEvent(e.events)),a.on("mouseover",()=>a.alpha=.1),a.on("mouseout",()=>a.alpha=r?.25:0),this.container.addChild(a)}this.parentContainer.addChild(this.container)}runEvents(e,t){this.disabled=!0,this.finishCallback&&this.finishCallback(e,e=>{this.disabled=!1,t&&t(e)})}triggerEvent(e){this.disabled||(console.log("clicked on hitbox",e),e?this.runEvents(e,e=>{this.parentContainer.removeChild(this.container),e?this.finishCallback&&this.finishCallback():this.setupContainer()}):(this.finishCallback&&this.finishCallback(),this.parentContainer.removeChild(this.container)))}ticker(e){}}class le{constructor(){this.eventQueue=[]}queueEvents(e,t){this.eventQueue.push({eventSpec:e,onDone:t})}dispatchQueuedEvents(e){let t=this.eventQueue;this.eventQueue=[];for(let i of t)e(i.eventSpec,i.onDone)}}class de{constructor(e,t,i,s){this.worldWidth=e,this.worldHeight=t,this.uiContainer=i,this.worldContainer=s,this.currentEventKey=0,this.tickers=[],this.currentEventKeys=[],this.queueEvents=!1,this.eventQueue=new le,P.on(y,()=>{this.currentEventKeys=[]}),P.on(b,()=>{this.queueEvents=!0}),P.on(f,()=>{this.queueEvents=!1,this.abortingFlow=!1,this._dispatchQueuedEvents()}),P.on(k,(e,t)=>{this.runEvents(e,t)}),new H(W,()=>{console.log("got escape key"),h.debug&&P.emit(y)}).bindListeners()}_runEvents(e,t,i){P.emit(d,!0),this.currentEventKeys.indexOf(i)<=-1&&this.currentEventKeys.push(i);let s=this.loadEvents(e),n=e=>{console.log("EVENT:",s[e]);const r=this._shouldAbortEvent(i);if(!s[e]||r)return P.emit(d,!1),void t(r);s[e](()=>n(e+1))};n(0)}_getEventKey(){return this.currentEventKey++}_shouldAbortEvent(e){return-1==this.currentEventKeys.indexOf(e)}runEvents(e,t){this.queueEvents?this.eventQueue.queueEvents(e,t):this._runEvents(e,t,this._getEventKey())}_dispatchQueuedEvents(){this.eventQueue.dispatchQueuedEvents(this._runEvents.bind(this))}loadEvents(e){let t=[];for(let i of e){let e=this.makeEventHandler(i);e?t.push(e):console.error("unknown event handler:",e)}return t}makeEventHandler(e){switch(e.type){case"text":return this.newTextHandler(e);case"slide":return this.newSlideHandler(e);case"event":return this.newEventDispatcher(e);case"check":return this.newCheck(e);case"quit":return this.newQuitEventFlow(e);case"delay":return this.newDelayEventsFlow(e)}return null}newCheck(e){return t=>{this.worldContainer.doCheck(e.key,e.check,e.case)?t():this._runEvents(e.events,t,this._getEventKey())}}newDelayEventsFlow(e){return t=>{let i=!1,s=()=>{!i&&t(),i=!0};e.async&&s(),window.setTimeout(()=>{e.events&&this._runEvents(e.events,()=>{},this._getEventKey()),s()},1e3*e.content)}}newTextHandler(e){return t=>{let i;return i=new oe(e.text,0,this.worldHeight-200,this.worldWidth,200,e,this.uiContainer,()=>{const e=this.tickers.indexOf(i);this.tickers.splice(e,1),t()},e.speaker_name),this.tickers.push(i),i}}newSlideHandler(e){return t=>{let i;return i=new he(e.image,this.uiContainer,this.worldContainer,e,(e,s)=>{if(e)this._runEvents(e,s,this._getEventKey());else{const e=this.tickers.indexOf(i);this.tickers.splice(e,1),t()}}),this.tickers.push(i),i}}newEventDispatcher(e){return t=>{P.emit(e.event,e.content),t()}}newQuitEventFlow(e){return e=>{P.emit(y),e()}}ticker(e){for(let t of this.tickers)t.ticker(e)}}class ce{constructor(){this.hunger=100,this.container=new s.Container;let e=new s.Graphics;e.lineStyle(4,16777215,1),e.beginFill(16777215,.8),e.drawRoundedRect(80,20,200,30,5),e.endFill(),this.container.addChild(e),this.setBar();let t=new s.Sprite(s.loader.resources.fish.texture);t.anchor.set(.5),t.x=40,t.y=35,t.scale.x=.7,t.scale.y=.7,t.rotation=-Math.PI/7,this.container.addChild(t),P.on(C,e=>{this.addHunger(e)})}setBar(){this.bar&&this.container.removeChild(this.bar),this.bar=new s.Graphics;let e=16753920;this.hunger<25&&(e=16711680),this.bar.beginFill(e,.8),this.bar.drawRoundedRect(80,20,this.hunger/100*200,30,5),this.bar.endFill(),this.container.addChild(this.bar)}getComponent(){return this.container}addHunger(e){this.hunger+=e,this.hunger>100&&(this.hunger=100),this.hunger<=0?(this.hunger=0,P.emit(k,[{type:"text",text:"You have run out of food!"},{type:"slide",image:"black_slide",events:[{type:"text",text:"...                                \nTux blacked out."}]}],()=>{this.hunger=100,this.setBar()})):this.setBar()}}var pe=i(101);let ue;P.on(x,e=>{ue.maxParticles=5e4*e,ue.spawnChance=e,ue.minimumSpeedMultiplier=e});class we{constructor(){this.temperature=50,this.container=new s.Container;let e=new s.Graphics;e.lineStyle(3,16777215,1),e.beginFill(16777215,.8),e.drawRoundedRect(80,70,200,15,7.5),e.endFill(),e.lineStyle(3,16777215,1),e.beginFill(16711680,1),e.drawCircle(93,77.5,15),e.endFill(),this.container.addChild(e),this.setBar();let t=new s.Sprite(s.loader.resources.thermo.texture);t.anchor.set(.5),t.x=40,t.y=79,t.scale.x=.7,t.scale.y=.7,this.container.addChild(t),P.on(S,e=>{this.setTemperature(e)}),P.on(x,e=>{this.temperature=50-50*e+20,this.setBar()}),this.container.alpha=0,P.on(u,e=>{"thermometer"===e.keys&&e.value&&(this.container.alpha=1)})}setBar(){this.bar&&this.container.removeChild(this.bar),this.bar=new s.Graphics,this.bar.beginFill(16711680,1),this.bar.drawRoundedRect(80,71,this.temperature/100*200,14,7.5),this.container.addChild(this.bar)}getComponent(){return this.container}setTemperature(e){this.temperature=e,this.setBar()}}i.d(t,"FULL_WIDTH",function(){return ge}),i.d(t,"GameApp",function(){return ve});const me="_splash";const ge=!1,ve=new s.Application(ge?window.innerWidth:1024,ge?window.innerHeight:768,{backgroundColor:1087931});let ye=new Set;function be(e,t){console.log(t),document.body.appendChild(ve.view);let i=function(e,t,i){let n=new s.extras.TilingSprite(e,t,i);return n.anchor.set(.5),n.tileScale.set(.5),n}(t.sea_background.texture,10*window.innerWidth,10*window.innerHeight);ve.stage.addChild(i);let n=0;ve.ticker.add(e=>{n+=e,i.x=32*Math.sin(n/200),i.y=32*Math.cos(n/125),i.scale.x=1+.04*Math.sin(n/500),i.scale.y=1+.04*Math.cos(n/400)});let r=new s.Container,o=new J(r);ve.stage.addChild(o.container);let h=new ne(ye);ve.stage.addChild(h.container),o.registerWorldChangeCallback(e=>{const t=e.getStartingPosition();h.setLocation(Z(t.x),Z(t.y))});let l=function(e,t,i){let n=new s.extras.TilingSprite(e,t,i);return n.anchor.set(.5),n.tileScale.set(2),n.alpha=.2,P.on(x,e=>{n.alpha=e}),n.blendMode=s.BLEND_MODES.SCREEN,n}(t.cloud.texture,10*window.innerWidth,10*window.innerHeight);ve.stage.addChild(l);let d=function(e){(ue=new pe.Emitter(e,[s.loader.resources.snow.texture],{alpha:{start:1,end:0},scale:{start:.2,end:.2,minimumScaleMultiplier:1},color:{start:"#ffffff",end:"#ffffff"},speed:{start:50,end:50,minimumSpeedMultiplier:.001},acceleration:{x:0,y:0},maxSpeed:0,startRotation:{min:40,max:50},noRotation:!0,rotationSpeed:{min:0,max:0},lifetime:{min:3,max:6},blendMode:"normal",frequency:.01,emitterLifetime:-1,maxParticles:500,pos:{x:0,y:0},addAtBack:!1,spawnType:"rect",spawnRect:{x:0,y:0,w:ve.renderer.width,h:ve.renderer.height}})).emit=!0;let t=1e3;return function(e){t+=e,ue.update(1e-4*t)}}(r);ve.ticker.add(d);let p=new ce;r.addChild(p.getComponent());let u=new a,w=u.getComponent();r.addChild(w),P.on(_,()=>{u.renderBackpack(h.backpack),w.x=ve.renderer.width-w.width});let m=new we;r.addChild(m.getComponent());let g=new de(ve.screen.width,ve.screen.height,r,o);P.on(c,e=>{g.runEvents(e,()=>{})}),ve.stage.addChild(r),ve.ticker.add(e=>{g.ticker(e)});let y=s.loader.resources.vignette.texture,b=new s.Sprite(y);b.width=ve.renderer.width,b.height=ve.renderer.height,ve.stage.addChild(b),ve.ticker.add(e=>{o.world.ticker(e,h),h.keyboardTick(e,o.world),ve.stage.pivot.x=h.getX()-ve.renderer.width/2,ve.stage.pivot.y=h.getY()-ve.renderer.height/2,o.doDetectCollisions(h.sprite.x,h.sprite.y);let t=h.getX()-ve.renderer.width/2,i=h.getY()-ve.renderer.height/2;r.x=t,r.y=i,b.x=t,b.y=i}),window.setWorld=(e=>{P.emit(v,e)})}function fe(){s.loader.add("sea_background","public/assets/sea.png").add("public/assets/penguin/penguin2.json").add("scratchcat","public/assets/sprites/scratchcat.png").add("berg","public/assets/sprites/berg.png").add("fish","public/assets/sprites/fish.png").add("thermo","public/assets/sprites/thermo.png").add("berg_big","public/assets/sprites/berg_big.png").add("walrus","public/assets/sprites/walrus.png").add("bear","public/assets/sprites/bear.png").add("iceicebaby","public/assets/sprites/iceicebaby.jpg").add("tuxside","public/assets/penguin/tux_side.png").add("walrusside","public/assets/penguin/walrus_side.png").add("bearside","public/assets/penguin/bear_side.png").add("piratewalrusside","public/assets/penguin/pirate_walrus_side.png").add("water_slide","public/assets/slides/water_slide.png").add("snow_slide","public/assets/slides/snow_slide.png").add("brochure","public/assets/slides/brochure.png").add("select_items","public/assets/slides/select_items.png").add("vignette","public/assets/vignette.png").add("snow","public/assets/particles/snow.png").add("cloud","public/assets/particles/cloud.png").add("splash","public/assets/slides/splash.png").add("ice_1_slide","public/assets/slides/ice_1_slide.png").add("ice_2_slide","public/assets/slides/ice_2_slide.png").add("sepia","public/assets/slides/sepia.png").add("black_slide","public/assets/slides/black_slide.png").add("empty","public/assets/sprites/empty.png").add("station","public/assets/sprites/station.png").add("station2","public/assets/sprites/station2.png").add("tent","public/assets/sprites/tent.png").load((e,t)=>{be(0,t),P.emit(v,me)})}let Ce=new s.loaders.Loader;Ce.add("worlds","public/assets/worlds/worlds.yaml"),Ce.load((e,t)=>{const i=r.a.safeLoad(t.worlds.data);for(let e of i)s.loader.add("world"+e+"_spec","public/assets/worlds/world"+e+".yaml").add("world"+e+"_tiles","public/assets/worlds/world"+e+".csv")}),Ce.onComplete.add(()=>{fe()})}});
//# sourceMappingURL=app.181c46cd.js.map